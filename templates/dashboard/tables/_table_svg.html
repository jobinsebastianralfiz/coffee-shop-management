{# Table SVG with chairs - reusable partial #}
{# Variables: table, chair_fill, chair_stroke, table_fill, status_text, status_color, is_ready, is_combined, combined_with #}

{% if user.role == 'super_admin' %}
<div class="relative cursor-pointer block group {% if is_ready %}animate-pulse{% endif %}"
     onclick="showTableDetails('{{ table.number }}', '{{ table.capacity }}', '{{ status_text }}', '{% if table.qr_code %}{{ table.qr_code.url }}{% endif %}', '{{ table.floor.name }}', '{% if table.floor.outlet %}{{ table.floor.outlet.name }}{% endif %}')">
{% else %}
<a href="{% url 'dashboard:table_take_order' table.pk %}" class="relative cursor-pointer block group {% if is_ready %}animate-pulse{% endif %}">
{% endif %}

    <!-- SVG Table with Chairs -->
    <svg width="{% if table.capacity <= 2 %}100{% elif table.capacity <= 4 %}120{% elif table.capacity <= 6 %}160{% else %}180{% endif %}"
         height="{% if table.capacity <= 2 %}100{% elif table.capacity <= 4 %}120{% else %}120{% endif %}"
         viewBox="0 0 {% if table.capacity <= 2 %}100 100{% elif table.capacity <= 4 %}120 120{% elif table.capacity <= 6 %}160 120{% else %}180 120{% endif %}"
         class="transition-transform duration-200 group-hover:scale-110">

        {% if table.capacity <= 2 %}
        <!-- 2-Seater: Square table with 2 chairs -->
        <!-- Left Chair -->
        <rect x="5" y="35" width="15" height="30" rx="4" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Right Chair -->
        <rect x="80" y="35" width="15" height="30" rx="4" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Table -->
        <rect x="25" y="25" width="50" height="50" rx="6" fill="{{ table_fill }}"/>
        <text x="50" y="55" text-anchor="middle" fill="white" font-weight="bold" font-size="14">{{ table.number }}</text>

        {% elif table.capacity <= 4 %}
        <!-- 4-Seater: Round table with 4 chairs -->
        <!-- Top Chair -->
        <rect x="45" y="5" width="30" height="15" rx="4" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Bottom Chair -->
        <rect x="45" y="100" width="30" height="15" rx="4" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Left Chair -->
        <rect x="5" y="45" width="15" height="30" rx="4" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Right Chair -->
        <rect x="100" y="45" width="15" height="30" rx="4" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Round Table -->
        <circle cx="60" cy="60" r="35" fill="{{ table_fill }}"/>
        <text x="60" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="14">{{ table.number }}</text>

        {% elif table.capacity <= 6 %}
        <!-- 6-Seater: Rectangle table with 6 chairs -->
        <!-- Top Chairs -->
        <rect x="35" y="5" width="25" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="100" y="5" width="25" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Bottom Chairs -->
        <rect x="35" y="103" width="25" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="100" y="103" width="25" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Side Chairs -->
        <rect x="5" y="45" width="12" height="30" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="143" y="45" width="12" height="30" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Rectangle Table -->
        <rect x="22" y="22" width="116" height="76" rx="8" fill="{{ table_fill }}"/>
        <text x="80" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="16">{{ table.number }}</text>

        {% else %}
        <!-- 8-Seater: Long rectangle table with 8 chairs -->
        <!-- Top Chairs -->
        <rect x="30" y="5" width="22" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="79" y="5" width="22" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="128" y="5" width="22" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Bottom Chairs -->
        <rect x="30" y="103" width="22" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="79" y="103" width="22" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="128" y="103" width="22" height="12" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Side Chairs -->
        <rect x="5" y="45" width="12" height="30" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <rect x="163" y="45" width="12" height="30" rx="3" fill="{{ chair_fill }}" stroke="{{ chair_stroke }}" stroke-width="2"/>
        <!-- Long Rectangle Table -->
        <rect x="22" y="22" width="136" height="76" rx="8" fill="{{ table_fill }}"/>
        <text x="90" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="16">{{ table.number }}</text>
        {% endif %}
    </svg>

    <!-- Status Label -->
    <div class="text-center mt-2">
        <span class="text-xs font-medium text-slate-500">{{ table.capacity }} seats</span>
        <span class="block text-xs font-semibold mt-0.5 {{ status_color }}">{{ status_text }}</span>
        {% if is_combined %}
        <span class="block text-xs text-indigo-600 mt-0.5">
            <svg class="w-3 h-3 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
            </svg>
            {% if combined_with %}+T{{ combined_with }}{% else %}Combined{% endif %}
        </span>
        {% endif %}
    </div>

    <!-- Ready indicator (pulsing dot) -->
    {% if is_ready %}
    <div class="absolute -top-1 -right-1 w-4 h-4 bg-purple-500 rounded-full animate-ping"></div>
    <div class="absolute -top-1 -right-1 w-4 h-4 bg-purple-500 rounded-full"></div>
    {% endif %}

    <!-- Combined indicator (link icon) -->
    {% if is_combined %}
    <div class="absolute -top-1 -left-1 w-5 h-5 bg-indigo-500 rounded-full flex items-center justify-center">
        <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
        </svg>
    </div>
    {% endif %}

{% if user.role == 'super_admin' %}
</div>
{% else %}
</a>
{% endif %}
